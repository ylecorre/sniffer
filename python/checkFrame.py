#! /usr/bin/python

import sys
import time
import packet

sourcePort = 137
destinationPort = 137
sourceAddress = "169.254.156.96"
destinationAddress = "169.254.255.255"
sourceMac = "e8:9d:87:0a:2c:24"
destinationMac = "ff:ff:ff:ff:ff:ff"
message = [
	0x8f,
	0x11,
	0x29,
	0x10,
	0x00,
	0x01,
	0x00,
	0x00,
	0x00,
	0x00,
	0x00,
	0x01,
	0x20,
	0x46,
	0x43,
	0x45,
	0x50,
	0x45,
	0x42,
	0x45,
	0x45,
	0x45,
	0x43,
	0x45,
	0x50,
	0x45,
	0x50,
	0x45,
	0x4c,
	0x43,
	0x41,
	0x43,
	0x41,
	0x43,
	0x41,
	0x43,
	0x41,
	0x43,
	0x41,
	0x43,
	0x41,
	0x43,
	0x41,
	0x41,
	0x41,
	0x00,
	0x00,
	0x20,
	0x00,
	0x01,
	0xc0,
	0x0c,
	0x00,
	0x20,
	0x00,
	0x01,
	0x00,
	0x04,
	0x93,
	0xe0,
	0x00,
	0x06,
	0x00,
	0x00,
	0xa9,
	0xfe,
	0x9c,
	0xc4
]

udp = packet.UdpPacket(sourcePort, destinationPort, packet.RawPacket(message))
ip = packet.IpPacket(sourceAddress, destinationAddress, udp)
eth = packet.EthernetPacket(destinationMac, sourceMac, ip)
print eth

pcap = packet.Pcap()
pcap.addFrame(eth)
pcap.dump("playback.pcap")

